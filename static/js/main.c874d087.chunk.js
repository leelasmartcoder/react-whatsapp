(this.webpackJsonpwhatsapp=this.webpackJsonpwhatsapp||[]).push([[0],{70:function(e,t,c){},71:function(e,t,c){},72:function(e,t,c){},82:function(e,t,c){},83:function(e,t,c){},84:function(e,t,c){},86:function(e,t,c){"use strict";c.r(t);var a=c(2),s=c.n(a),n=c(29),r=c.n(n),i=(c(70),c(13)),o=c(35),j=c(10),d=(c(71),c(72),c(101)),l=c(99),b=c(45),h=c.n(b),u=c(56),O=c.n(u),m=c(44),p=c.n(m),x=c(57),f=c.n(x),v=c(58),g=c.n(v),N=c(32),S=N.a.initializeApp({apiKey:"AIzaSyCfxTONy-36L39bxAJ9UCcZndLTn3DNOTU",authDomain:"whatsapp-6dcd7.firebaseapp.com",databaseURL:"https://whatsapp-6dcd7-default-rtdb.firebaseio.com",projectId:"whatsapp-6dcd7",storageBucket:"whatsapp-6dcd7.appspot.com",messagingSenderId:"691672258710",appId:"1:691672258710:web:d51992c913ce187ad2cab7",measurementId:"G-YENBZ2W965"}).firestore(),w=N.a.auth(),_=new N.a.auth.GoogleAuthProvider,y=S,C=c(3),E=Object(a.createContext)(),I=function(e){var t=e.reducer,c=e.initialState,s=e.children;return Object(C.jsx)(E.Provider,{value:Object(a.useReducer)(t,c),children:s})},T=function(){return Object(a.useContext)(E)};function A(){var e,t,c=Object(a.useState)(""),s=Object(i.a)(c,2),n=s[0],r=s[1],o=Object(a.useState)(""),b=Object(i.a)(o,2),u=b[0],m=b[1],x=Object(a.useState)(""),v=Object(i.a)(x,2),S=(v[0],v[1],Object(j.f)().roomId),w=Object(a.useState)(""),_=Object(i.a)(w,2),E=_[0],I=_[1],A=Object(a.useState)([]),U=Object(i.a)(A,2),D=U[0],B=U[1],J=T(),R=Object(i.a)(J,2),k=R[0].user;R[1];Object(a.useEffect)((function(){S&&(console.log("roomId: "+S),y.collection("rooms").doc(S).onSnapshot((function(e){return I(e.data().name)})),y.collection("rooms").doc(S).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){return B(e.docs.map((function(e){return e.data()})))})))}),[S]),Object(a.useEffect)((function(){r(Math.floor(5e3*Math.round()))}),[S]);return Object(C.jsx)(C.Fragment,{children:Object(C.jsxs)("div",{className:"chat",children:[Object(C.jsxs)("div",{className:"chat_header",children:[Object(C.jsx)(d.a,{src:"https://avatars.dicebear.com/4.5/api/human/".concat(n,".svg")}),Object(C.jsxs)("div",{className:"chat_headerinfo",children:[Object(C.jsx)("h2",{children:E}),Object(C.jsxs)("p",{children:["Last Seen At ","",new Date(null===(e=D[D.length-1])||void 0===e||null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()]})]}),Object(C.jsxs)("div",{className:"chat_headerRight",children:[Object(C.jsx)(l.a,{children:Object(C.jsx)(p.a,{})}),Object(C.jsx)(l.a,{children:Object(C.jsx)(O.a,{})}),Object(C.jsx)(l.a,{children:Object(C.jsx)(h.a,{})})]})]}),Object(C.jsx)("div",{className:"chat_body",children:D.map((function(e){var t;return Object(C.jsxs)("p",{className:"chat_message ".concat(e.name===k.displayName&&"chat_reciever"),children:[Object(C.jsx)("span",{className:"chat_name",children:e.name}),e.message,Object(C.jsx)("span",{className:"chat_timestamp",children:new Date(null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()})]})}))}),Object(C.jsxs)("div",{className:"chat_footer",children:[Object(C.jsx)(f.a,{}),Object(C.jsxs)("form",{onSubmit:function(e){e.preventDefault(),console.log("you typed--",u),y.collection("rooms").doc(S).collection("messages").add({message:u,name:k.displayName,timestamp:N.a.firestore.FieldValue.serverTimestamp()}),m("")},children:[Object(C.jsx)("input",{type:"text",placeholder:"Type a message",value:u,onChange:function(e){m(e.target.value)}}),Object(C.jsx)("button",{children:"Send"})]}),Object(C.jsx)(g.a,{})]})]})})}var U=c(59),D=c(100),B=(c(82),c(49)),J="SET_USER",R=function(e,t){switch(console.log(t),t.type){case J:return Object(B.a)(Object(B.a)({},e),{},{user:t.user});default:return e}};function k(){var e=T(),t=Object(i.a)(e,2);Object(U.a)(t[0]);var c=t[1];return Object(C.jsx)(C.Fragment,{children:Object(C.jsx)("div",{className:"login",children:Object(C.jsxs)("div",{className:"login_container",children:[Object(C.jsx)("img",{src:"https://play-lh.googleusercontent.com/bYtqbOcTYOlgc6gqZ2rwb8lptHuwlNE75zYJu6Bn076-hTmvd96HH-6v7S0YUAAJXoJN",alt:""}),Object(C.jsx)("div",{className:"login_text",children:Object(C.jsx)("h1",{children:"Sign in to WhatsApp "})}),Object(C.jsx)(D.a,{onClick:function(){w.signInWithPopup(_).then((function(e){c({type:J,user:e.user})})).catch((function(e){return alert(e.message)}))},children:"Sign in with google"})]})})})}c(83);var F=c(61),L=c.n(F),M=c(60),Y=c.n(M);c(84);function P(e){var t,c=e.id,s=e.name,n=e.addNewChat,r=Object(a.useState)(""),j=Object(i.a)(r,2),l=j[0],b=j[1],h=Object(a.useState)(""),u=Object(i.a)(h,2),O=u[0],m=u[1];Object(a.useEffect)((function(){c&&y.collection("rooms").doc(c).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return m(e.docs.map((function(e){return e.data()})))}))}),[c]),Object(a.useEffect)((function(){b(Math.floor(5e3*Math.random()))}),[]);return n?Object(C.jsx)("div",{onClick:function(){var e=prompt("Please enter room name");e&&y.collection("rooms").add({name:e})},className:"sidebarchat",children:Object(C.jsx)("h2",{children:"Add New Chat"})}):Object(C.jsx)(C.Fragment,{children:Object(C.jsx)(o.b,{to:"/rooms/".concat(c),children:Object(C.jsxs)("div",{className:"sidebarchat",children:[Object(C.jsx)(d.a,{src:"https://avatars.dicebear.com/4.5/api/human/".concat(l,".svg")}),Object(C.jsxs)("div",{className:"sidebarchat_info",children:[Object(C.jsx)("h2",{children:s}),Object(C.jsx)("p",{children:null===(t=O[0])||void 0===t?void 0:t.message})]})]})})})}function z(){var e=Object(a.useState)([]),t=Object(i.a)(e,2),c=t[0],s=t[1],n=T(),r=Object(i.a)(n,2),o=r[0].user;r[1];return Object(a.useEffect)((function(){var e=y.collection("rooms").onSnapshot((function(e){return s(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}));return function(){e()}}),[]),Object(C.jsx)(C.Fragment,{children:Object(C.jsxs)("div",{className:"sidebar",children:[Object(C.jsxs)("div",{className:"sidebar_header",children:[Object(C.jsx)(d.a,{src:null===o||void 0===o?void 0:o.photoURL}),Object(C.jsxs)("div",{className:"sidebar_headerRight",children:[Object(C.jsx)(l.a,{children:Object(C.jsx)(Y.a,{})}),Object(C.jsx)(l.a,{children:Object(C.jsx)(L.a,{})}),Object(C.jsx)(l.a,{children:Object(C.jsx)(h.a,{})})]})]}),Object(C.jsx)("div",{className:"sidebar_search",children:Object(C.jsxs)("div",{className:"sidebar_searchcontainer",children:[Object(C.jsx)(p.a,{}),Object(C.jsx)("input",{type:"text",placeholder:"search or start new chat"})]})}),Object(C.jsxs)("div",{className:"sidebar_chat",children:[Object(C.jsx)(P,{addNewChat:!0}),c.map((function(e){return Object(C.jsx)(P,{id:e.id,name:e.data.name},e.id)}))]})]})})}function H(){var e=T(),t=Object(i.a)(e,2),c=t[0].user;t[1];return Object(C.jsx)("div",{className:"app",children:c?Object(C.jsx)("div",{className:"app_body",children:Object(C.jsx)(o.a,{children:Object(C.jsxs)(j.c,{children:[Object(C.jsxs)(j.a,{path:"/rooms/:roomId",children:[Object(C.jsx)(z,{}),Object(C.jsx)(A,{})]}),Object(C.jsx)(j.a,{path:"/",children:Object(C.jsx)(z,{})})]})})}):Object(C.jsx)(k,{})})}r.a.render(Object(C.jsx)(s.a.StrictMode,{children:Object(C.jsx)(I,{initialState:{user:null},reducer:R,children:Object(C.jsx)(H,{})})}),document.getElementById("root"))}},[[86,1,2]]]);
//# sourceMappingURL=main.c874d087.chunk.js.map